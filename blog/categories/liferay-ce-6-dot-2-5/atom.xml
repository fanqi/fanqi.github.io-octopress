<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Liferay Ce 6.2.5 | 范琪的个人博客]]></title>
  <link href="http://www.fanqi.xyz/blog/categories/liferay-ce-6-dot-2-5/atom.xml" rel="self"/>
  <link href="http://www.fanqi.xyz/"/>
  <updated>2016-05-27T12:32:01+08:00</updated>
  <id>http://www.fanqi.xyz/</id>
  <author>
    <name><![CDATA[范琪]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Liferay Portlet 生命周期]]></title>
    <link href="http://www.fanqi.xyz/blog/2016/05/25/liferay-portlet-lifecycle/"/>
    <updated>2016-05-25T09:02:46+08:00</updated>
    <id>http://www.fanqi.xyz/blog/2016/05/25/liferay-portlet-lifecycle</id>
    <content type="html"><![CDATA[<h2>概述</h2>

<p>了解portlet的生命周期，对于liferay portlet开发者来说是一个基本的要求。
portlet的生命周期分为六个阶段：<br/>
1. init
1. render
1. processAction
1. processEvent
1. serveResource
1. destroy</p>

<h2>示例代码</h2>

<p>view.jsp
```
&lt;%@ taglib uri=&ldquo;<a href="http://java.sun.com/portlet_2_0">http://java.sun.com/portlet_2_0</a>&rdquo; prefix=&ldquo;portlet&rdquo;%></p>

<p>&lt;portlet:defineObjects /></p>

<p>This is the
<b>Lifecycle</b>
portlet in View mode.
<br></p>

<p>&lt;portlet:renderURL var=&ldquo;viewURL&rdquo; />
<a href="<%=viewURL%>&ldquo;>viewURL</a>
<br>
&lt;portlet:actionURL var="actionURL&rdquo; name=&ldquo;doAction&rdquo;>&lt;/portlet:actionURL>
<a href="<%=actionURL%>&ldquo;>actionURL</a>
<br>
&lt;portlet:resourceURL var="resourceURL&rdquo; />
<a href="<%=resourceURL%>&ldquo;>resourceURL</a>
<br>
<code>
LifecyclePortlet.java
</code> java
public class LifecyclePortlet extends MVCPortlet {</p>

<pre><code>@Override
public void init() throws PortletException {
    System.out.println("Lifecycle Phase (MVCPortlet) : init");
    super.init();
}

@Override
public void init(PortletConfig config) throws PortletException {
    System.out.println("Lifecycle Phase (GenericPortlet) : init");
    super.init(config);
}

@Override
public void render(RenderRequest arg0, RenderResponse arg1)
        throws PortletException, IOException {
    System.out.println("Lifecycle Phase: render");
    super.render(arg0, arg1);
}

@Override
public void processAction(ActionRequest actionRequest,
        ActionResponse actionResponse) throws IOException, PortletException {
    System.out.println("Lifecycle Phase: processAction");
    super.processAction(actionRequest, actionResponse);
}

public void doAction(ActionRequest actionRequest,
        ActionResponse actionResponse) throws IOException, PortletException {
    System.out.println("LifecyclePortlet: doAction");
}

@Override
public void processEvent(EventRequest arg0, EventResponse arg1)
        throws PortletException, IOException {
    System.out.println("Lifecycle Phase: processEvent");
    super.processEvent(arg0, arg1);
}

@Override
public void serveResource(ResourceRequest resourceRequest,
        ResourceResponse resourceResponse) throws IOException,
        PortletException {
    System.out.println("Lifecycle Phase: serveResource");
    resourceResponse.setContentType("text/html;charset=UTF-8");
    PrintWriter out = null;
    try {
        out = resourceResponse.getWriter();
    } catch (IOException e) {
        e.printStackTrace();
    }
    String result = "serveResource";
    out.println(result);
    out.flush();
    out.close();
    super.serveResource(resourceRequest, resourceResponse);
}

@Override
public void destroy() {
    System.out.println("Lifecycle Phase (GenericPortlet) : destroy");
    super.destroy();
}
</code></pre>

<p>}
```</p>

<h2>init</h2>

<p>一个portlet在portlet容器中被部署及实例化的时候，就会调用init方法，该方法在portlet生命周期中仅仅只会被调用一次。<br/>
init阶段对应init()和init(PortletConfig config)两个实现方法，这两个方法分别定义在MVCPortlet和GenericPortlet，而GenericPortlet是MVCPortlet的父类，因此init(PortletConfig config)方法先执行。<br/>
init执行如下：<br/>
<code>
00:58:09,934 INFO  [localhost-startStop-7][PortletHotDeployListener:344] Registering portlets for lportal-ce-6.2.5-lifecycle-portlet
Lifecycle Phase (GenericPortlet) : init
Lifecycle Phase (MVCPortlet) : init
00:58:09,964 INFO  [localhost-startStop-7][PortletHotDeployListener:492] 1 portlet for lportal-ce-6.2.5-lifecycle-portlet is available for use
</code></p>

<h2>render</h2>

<p>在portal页面中显示portlet的内容，就会调用render方法。<br/>
render方法就是负责生成portlethtml内容。<br/>
也可以通过renderURL来调用render方法加载不同的网页内容。
在portlet的生命周期中，render方法应该是被调用次数最多的。
<code>
Lifecycle Phase (GenericPortle) : render
</code></p>

<h2>processAction</h2>

<p>当有任何action执行的时候，processAction都被先调用。
例如通过actionURL向后台action方法提交表单数据，就会先触发processAction。
在portlet的生命周期中，processAction方法能够被多次调用。
<code>
Lifecycle Phase (MVCPortlet) : processAction
LifecyclePortlet: doAction
</code></p>

<h2>processEvent</h2>

<p>当任何时间被触发的时候，就会调用processEvent方法。</p>

<h2>serveResource</h2>

<p>通过serveResource方法，能够获取portlet提供的服务端资源，包括html、json、xml等。<br/>
在jsp中我们能够通过请求resourceURL，来调用serveResource方法。<br/>
ajax也能够和resourceURL结合使用。<br/>
在portlet的生命周期中，serveResource能够被多次调用。<br/>
<code>
Lifecycle Phase (MVCPortlet) : serveResource
</code></p>

<h2>destroy</h2>

<p>当卸载一个portlet的时候，就会调用它的destroy方法。
在portlet的生命周期中，destroy方法只会被执行一次。
<code>
01:35:10,248 INFO  [ContainerBackgroundProcessor[StandardEngine[Catalina]]][PortletHotDeployListener:525] Unregistering portlets for lportal-ce-6.2.5-demo-portlet
Lifecycle Phase (GenericPortlet) : destroy
01:35:10,250 INFO  [ContainerBackgroundProcessor[StandardEngine[Catalina]]][PortletHotDeployListener:560] 1 portlet for lportal-ce-6.2.5-lifecycle-portlet was unregistered
</code></p>

<h2>参考资源</h2>

<ol>
<li><a href="http://liferaytutorial.blogspot.com/2013/04/portlet-lifecycle.html">http://liferaytutorial.blogspot.com/2013/04/portlet-lifecycle.html</a></li>
<li><a href="http://www.opensource-techblog.com/2014/12/introduction-to-portlet-phases-and.html">http://www.opensource-techblog.com/2014/12/introduction-to-portlet-phases-and.html</a></li>
<li><a href="http://proliferay.com/jsr-286-portlet-life-cycle/">http://proliferay.com/jsr-286-portlet-life-cycle/</a></li>
</ol>

]]></content>
  </entry>
  
</feed>
