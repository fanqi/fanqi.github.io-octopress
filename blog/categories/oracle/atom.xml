<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Oracle | 范琪的个人博客]]></title>
  <link href="http://www.fanqi.xyz/blog/categories/oracle/atom.xml" rel="self"/>
  <link href="http://www.fanqi.xyz/"/>
  <updated>2016-05-25T11:13:16+08:00</updated>
  <id>http://www.fanqi.xyz/</id>
  <author>
    <name><![CDATA[范琪]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Oracle常用运维命令]]></title>
    <link href="http://www.fanqi.xyz/blog/2016/05/24/oracle-command/"/>
    <updated>2016-05-24T15:45:36+08:00</updated>
    <id>http://www.fanqi.xyz/blog/2016/05/24/oracle-command</id>
    <content type="html"><![CDATA[<h2>导出数据</h2>

<pre><code>exp orcl/orcl@orcl file=d:\orcl.dmp log=d:\orcl.log
</code></pre>

<h2>导入数据</h2>

<pre><code>imp orcl/orcl@orcl  file=d:\orcl.dmp full=y
</code></pre>

<h2>自动备份脚本（Windows Server版本）（待完善自动压缩）</h2>

<p>命名成后缀为.bat的脚本，双击即可执行备份，结合任务计划就能够实现每天自动备份。</p>

<pre><code>rem if ""%1""=="""" goto end
rem if ""%2""=="""" goto end

set path=f:\db_bak_lqgt;%path%
set now=%Date:~0,10%
exp orcl/orcl@orcl file=f:\db_bak_orcl\orcl_%now%.dmp log=f:\db_bak_orcl\orcl_%now%.log buffer=1024000

echo file in %1.dmp,%1.log
rem pause

for /f "skip=30" %%i in ('dir *.log /tc /o-d /b') do del %%i

for /f "skip=30" %%i in ('dir *.dmp /tc /o-d /b') do del %%i

exit

:end
echo 参数必须指定
pause
</code></pre>

<h2>批量删除当前用户所有表</h2>

<pre><code class="SQL">SELECT 'drop table '||table_name||';' FROM USER_TABLES ORDER BY TABLE_NAME;
</code></pre>

<h2>不登陆启动sqlplus</h2>

<p>sqlplus /nolog</p>

<h2>使用系统用户连接数据库（只能在服务器使用）</h2>

<p>conn /as sysdba;</p>

<h2>查看表空间使用情况</h2>

<pre><code class="SQL">SELECT
  SUM(bytes) / (1024 * 1024)  "M free_space",
  tablespace_name
FROM dba_free_space
GROUP BY tablespace_name;

SELECT
  a.tablespace_name,
  round(a.bytes  / (1024 * 1024),2)  "M TOTAL",
  round(b.bytes  / (1024 * 1024),2)  "M USED",
  round(c.bytes  / (1024 * 1024),2)  "M FREE",
  round((b.bytes * 100) / a.bytes,2) "% USED",
  round((c.bytes * 100) / a.bytes,2) "% FREE"
FROM sys.sm$ts_avail a, sys.sm$ts_used b, sys.sm$ts_free c
WHERE a.tablespace_name = b.tablespace_name
      AND a.tablespace_name = c.tablespace_name;
</code></pre>

<h2>增加表空间数据文件（注意重新命名数据文件）</h2>

<pre><code class="SQL">ALTER TABLESPACE SYSTEM
ADD DATAFILE 'D:\oradata\orcl\SYSTEM02.DBF'
SIZE 512m
AUTOEXTEND ON
NEXT 512m
MAXSIZE 4096m;
</code></pre>
]]></content>
  </entry>
  
</feed>
